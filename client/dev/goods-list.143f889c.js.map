{"version":3,"sources":["src/views/Goods/goods-list.vue"],"names":[],"mappings":"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","file":"goods-list.143f889c.js","sourceRoot":"..","sourcesContent":["<template>\r\n  <div class=\"container\">\r\n    <div class=\"limit-width center scroll-x\">\r\n      <!-- search -->\r\n      <div class=\"search-box\" @keydown.enter=\"search()\">\r\n        <el-autocomplete\r\n          class=\"inline-input\"\r\n          v-model=\"querys.goodsID\"\r\n          :fetch-suggestions=\"suggest\"\r\n          placeholder=\"请输入货品编码\"\r\n          :trigger-on-focus=\"false\"\r\n        ></el-autocomplete>\r\n        <el-button type=\"primary\" @click=\"search()\">查找</el-button>\r\n      </div>\r\n      <!-- search:end -->\r\n      <!-- table -->\r\n      <div style=\"min-height: 500px\" ref=\"table\">\r\n        <el-table v-loading=\"loading\" :data=\"listData.data\" border fit show-header>\r\n          <el-table-column\r\n            v-for=\"collumn in collumns\"\r\n            :key=\"collumn.prop\"\r\n            :prop=\"collumn.prop\"\r\n            :label=\"collumn.label\"\r\n            :width=\"collumn.width\"\r\n          ></el-table-column>\r\n          <el-table-column label=\"操作\">\r\n            <template slot-scope=\"scope\">\r\n              <el-button size=\"mini\" @click=\"handleEdit(scope.row)\">修改</el-button>\r\n              <el-popover placement=\"top\" width=\"280\">\r\n                <p>确定删除\"{{scope.row.name}}({{scope.row.goods_id}})\"吗？</p>\r\n                <div style=\"text-align: right; margin: 0\">\r\n                  <el-button size=\"mini\" type=\"text\" @click=\"$refs.table.click()\">取消</el-button>\r\n                  <el-button type=\"primary\" size=\"mini\" @click=\"handleDelete(scope.row)\">确定</el-button>\r\n                </div>\r\n                <el-button slot=\"reference\" size=\"mini\" type=\"danger\">删除</el-button>\r\n              </el-popover>\r\n            </template>\r\n          </el-table-column>\r\n        </el-table>\r\n      </div>\r\n      <!-- table:end -->\r\n      <!-- pager -->\r\n      <div class=\"text-align-right\">\r\n        <el-pagination\r\n          :page-size=\"querys.perPage\"\r\n          :pager-count=\"11\"\r\n          layout=\"total, prev, pager, next\"\r\n          :total=\"listData.count\"\r\n        ></el-pagination>\r\n      </div>\r\n      <!-- pager:end -->\r\n      <!-- dialogs -->\r\n      <edit-form @on-update-item=\"onUpdateItem\" ref=\"editForm\"></edit-form>\r\n      <!-- dialogs:end -->\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport editForm from \"./editForm\";\r\n\r\nexport default {\r\n  components: {\r\n    \"edit-form\": editForm\r\n  },\r\n  data() {\r\n    return {\r\n      querys: {\r\n        goodsID: \"\",\r\n        perPage: 20,\r\n        page: 1\r\n      },\r\n      loading: false,\r\n      listData: {\r\n        data: [],\r\n        count: 0\r\n      },\r\n      collumns: [\r\n        {\r\n          prop: \"goods_id\",\r\n          label: \"货品编码\",\r\n          width: \"160\"\r\n        },\r\n        {\r\n          prop: \"name\",\r\n          label: \"名称\",\r\n          width: \"200\"\r\n        },\r\n        {\r\n          prop: \"name_e\",\r\n          label: \"名称(英文)\",\r\n          width: \"200\"\r\n        },\r\n        {\r\n          prop: \"addr\",\r\n          label: \"地址\",\r\n          width: \"300\"\r\n        },\r\n        {\r\n          prop: \"addr_e\",\r\n          label: \"地址(英文)\",\r\n          width: \"300\"\r\n        }\r\n      ],\r\n      timeout: null\r\n    };\r\n  },\r\n  created() {\r\n    this.search();\r\n  },\r\n  activated() {\r\n    this.search();\r\n  },\r\n  methods: {\r\n    search(page) {\r\n      if (!page) {\r\n        this.querys.page = 1;\r\n      } else {\r\n        this.querys.page = page;\r\n      }\r\n      let specGoodsID = this.querys.goodsID;\r\n      this.loading = true;\r\n      this.$api\r\n        .get(\"/goods/list\", {\r\n          params: {\r\n            page: this.querys.page,\r\n            per_page: this.querys.perPage,\r\n            goods_id: this.querys.goodsID\r\n          }\r\n        })\r\n        .then(res => {\r\n          this.listData.data = res.data.list;\r\n          this.listData.count = res.data.count;\r\n          this.loading = false;\r\n        })\r\n        .catch(err => {\r\n          this.loading = false;\r\n          let resp = err.response;\r\n          if (!resp) {\r\n            return alert(resp.message);\r\n          }\r\n          if (resp.status === 401) {\r\n            this.$emit(\"not-login\");\r\n          }\r\n        });\r\n    },\r\n    // 输入建议\r\n    suggest(goods_id, cb) {\r\n      if (!goods_id) {\r\n        return cb(null);\r\n      }\r\n      clearTimeout(this.timeout);\r\n      this.$api\r\n        .get(\"/goods/suggest\", {\r\n          params: {\r\n            goods_id: goods_id\r\n          }\r\n        })\r\n        .then(res => {\r\n          this.timeout = setTimeout(() => {\r\n            cb(res.data.map(e => ({ value: e })));\r\n          }, 500);\r\n        })\r\n        .catch(err => {});\r\n    },\r\n    // 删除\r\n    handleDelete(row) {\r\n      let goodsId = row.goods_id;\r\n      this.loading = true;\r\n      this.$api\r\n        .delete(`goods/${goodsId}`)\r\n        .then(res => {\r\n          this.$message(\"已删除。\");\r\n          this.search(this.querys.page);\r\n          this.$refs.table.click();\r\n          this.loading = false;\r\n        })\r\n        .catch(err => {\r\n          this.loading = false;\r\n          let resp = err.response;\r\n          if (!resp) {\r\n            return this.$message.error(err.message);\r\n          }\r\n          // 未登录\r\n          if (resp.status === 401) {\r\n            return this.$emit(\"not-login\");\r\n          }\r\n          // 具体报错\r\n          let reason = (function() {\r\n            let str = \"\";\r\n            try {\r\n              str = resp.data.message;\r\n            } catch (e) {\r\n              console.log(e);\r\n            }\r\n            return str;\r\n          })();\r\n          this.$message.error(\"删除失败。\" + reason);\r\n        });\r\n    },\r\n    // 修改\r\n    handleEdit(row) {\r\n      this.$refs.editForm.open(row);\r\n    },\r\n    onUpdateItem(data, cb) {\r\n      if (!data) return cb();\r\n      this.loading = true;\r\n\r\n      let action = this.$api\r\n        .put(`/goods/${data.goods_id}`, { item: data })\r\n        .then(() => {\r\n          this.search(this.querys.page);\r\n        });\r\n      this.loading = false;\r\n      cb(action);\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style lang=\"stylus\" scoped>\r\n.container\r\n  width 100%\r\n  min-height 100vh\r\n  background #fefefe\r\n  box-sizing border-box\r\n  padding 16px 16px 16px 16px\r\n  .search-box\r\n    width 100%\r\n    padding 16px\r\n    box-sizing border-box\r\n    .input\r\n      width 300px\r\n</style>\r\n\r\n"]}